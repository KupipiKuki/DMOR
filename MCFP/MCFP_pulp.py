# -*- coding: utf-8 -*-
"""
Created on Sun Nov 16 08:53:25 2025

@author: jmc53
"""

import pandas as pd
import numpy as np
import pulp

branches=np.array([
	[1,4,0,50,1,4],
	[2,4,0,100,1,5],
	[3,5,0,60,1,6],
	[4,4,0,20,1,7],
	[5,5,0,120,2,4],
	[6,1,0,100,2,5],
	[7,7,0,100,2,6],
	[8,9,0,80,2,7],
	[9,8,0,50,3,4],
	[10,2,0,70,3,5],
	[11,8,0,40,3,6],
	[12,2,0,80,3,7],
	[13,3,0,15,4,8],
	[14,4,0,11,4,9],
	[15,7,0,11,4,10],
	[16,10,0,6,4,11],
	[17,7,0,12,4,12],
	[18,6,0,11,4,13],
	[19,3,0,9,4,14],
	[20,8,0,8,4,15],
	[21,2,0,10,4,16],
	[22,2,0,14,4,17],
	[23,3,0,11,4,18],
	[24,10,0,9,4,19],
	[25,7,0,12,4,20],
	[26,6,0,11,4,21],
	[27,7,0,11,4,22],
	[28,5,0,10,4,23],
	[29,3,0,11,4,24],
	[30,10,0,10,4,25],
	[31,9,0,9,4,26],
	[32,8,0,9,4,27],
	[33,5,0,10,5,8],
	[34,9,0,13,5,9],
	[35,10,0,7,5,10],
	[36,9,0,6,5,11],
	[37,4,0,14,5,12],
	[38,3,0,11,5,13],
	[39,3,0,11,5,14],
	[40,6,0,13,5,15],
	[41,9,0,7,5,16],
	[42,3,0,10,5,17],
	[43,3,0,12,5,18],
	[44,1,0,12,5,19],
	[45,1,0,14,5,20],
	[46,3,0,13,5,21],
	[47,6,0,10,5,22],
	[48,3,0,7,5,23],
	[49,4,0,6,5,24],
	[50,1,0,13,5,25],
	[51,8,0,8,5,26],
	[52,10,0,15,5,27],
	[53,6,0,15,6,8],
	[54,10,0,12,6,9],
	[55,6,0,11,6,10],
	[56,3,0,13,6,11],
	[57,2,0,6,6,12],
	[58,9,0,10,6,13],
	[59,3,0,12,6,14],
	[60,4,0,12,6,15],
	[61,5,0,8,6,16],
	[62,8,0,13,6,17],
	[63,2,0,11,6,18],
	[64,3,0,14,6,19],
	[65,2,0,6,6,20],
	[66,6,0,12,6,21],
	[67,7,0,7,6,22],
	[68,1,0,14,6,23],
	[69,7,0,13,6,24],
	[70,7,0,8,6,25],
	[71,7,0,8,6,26],
	[72,8,0,9,6,27],
	[73,2,0,7,7,8],
	[74,1,0,15,7,9],
	[75,2,0,6,7,10],
	[76,7,0,13,7,11],
	[77,5,0,8,7,12],
	[78,8,0,8,7,13],
	[79,2,0,14,7,14],
	[80,7,0,12,7,15],
	[81,5,0,6,7,16],
	[82,4,0,10,7,17],
	[83,3,0,8,7,18],
	[84,9,0,10,7,19],
	[85,4,0,8,7,20],
	[86,8,0,6,7,21],
	[87,5,0,13,7,22],
	[88,3,0,12,7,23],
	[89,5,0,9,7,24],
	[90,1,0,7,7,25],
	[91,4,0,7,7,26],
	[92,4,0,11,7,27]
	])

nodes=np.array([
	[1,100],
	[2,200],
	[3,120],
	[4,0],
	[5,0],
	[6,0],
	[7,0],
	[8,-20],
	[9,-30],
	[10,-15],
	[11,-25],
	[12,-10],
	[13,-15],
	[14,-15],
	[15,-25],
	[16,-11],
	[17,-20],
	[18,-30],
	[19,-29],
	[20,-22],
	[21,-8],
	[22,-40],
	[23,-28],
	[24,-24],
	[25,-30],
	[26,-11],
	[27,-12]
	])

n_b=branches[:,0]
n_n=nodes[:,0]
c=branches[:,1]
lb=branches[:,2]
ub=branches[:,3]
i=branches[:,4]
j=branches[:,5]
b=nodes[:,1]

prob = pulp.LpProblem("InventoryProblem",pulp.LpMinimize)

x = pulp.LpVariable.dicts("x",(n_b),0,None,pulp.LpContinuous)

prob += pulp.lpSum([c[a-1]*x[a] for a in n_b]), 'cost'

for n in n_n:
    prob += pulp.lpSum([x[a+1] for a in np.where(i==n)[0]]+[-1*x[a+1] for a in np.where(j==n)[0]]) == b[n-1], f'inventory {n}'

for n in n_b:
    prob += pulp.lpSum(x[n]) >= lb[n-1], f'lower_b {n}'
    
for n in n_b:
    prob += pulp.lpSum(x[n]) <= ub[n-1], f'upper_b {n}'

prob.solve()
print(f'Solver: {prob.solver}')
print(pulp.value(prob.objective))
